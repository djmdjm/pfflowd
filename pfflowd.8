.\" $Id: pfflowd.8,v 1.1.1.1 2003/06/22 03:42:25 djm Exp $
.\"
.\" Copyright (c) 2003 Damien Miller.  All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
.\" IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
.\" OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
.\" IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
.\" INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
.\" NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
.\" DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
.\" THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
.\" (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
.\" THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
.\"
.Dd June 22, 2003
.Dt PFFLOWD 8
.Os
.Sh NAME
.Nm pfflowd
.Nd Traffic flow monitoring
.Sh SYNOPSIS
.Nm pfflowd
.Op Fl dDh
.Op Fl i Ar interface
.Op Fl r Ar pcap_file
.Op Fl n Ar host:port
.Op bpf_program
.Sh DESCRIPTION
.Nm
is a daemon which converts status update packets from
.Xr pf 4
sent over its
.Xr pfsync 4
interface to Cisco NetFlow(tm) datagrams. These UDP datagrams are then 
exported to the specified
.Ar host
and
.Ar port .
.Pp
The command-line options are as follows:
.Bl -tag -width Ds
.It Fl n Ar host:port
Specify the 
.Ar host
(an IP address in dotted-quad format) and 
.Ar port
that the accounting datagrams are to be sent to. Note that it is possible
to run this daemon without specifying a host and port to export flows to,
but this doesn't make much sense unless one is running in debug mode.
.It Fl i Ar interface
Specify a network interface on which to listen for traffic.
.Fl i
or the
.Fl r 
As it only makes sense to listen on 
.Xr pfsync 4
interfaces, this argument is optional (defaulting to pfsync0).
.It Fl r Ar pcap_file
Specify that
.Nm
should read from a 
.Xr pcap 3
packet capture (such as one created with the 
.Fl w
option of 
.Xr tcpdump 8 )
file rather than a network interface. 
.Nm
will process the whole capture file and then exit. One would normally use
the 
.Fl d
flag to keep the process in the foreground in this mode.
.It Fl d
Specify that 
.Nm
should not fork and daemonise itself.
.It Fl D
Places
.Nm
in a debugging mode. This implies the 
.Fl d
flag and turns on additional debugging output.
.It Fl h
Displays commandline usage information.
.El
.Pp
Any further commandline arguments will be concatenated together and 
applied as a 
.Xr bpf 4
packet filter. This filter will cause 
.Nm
to ignore the specified traffic.
.Sh AUTHORS
Damien Miller <djm@mindrot.org>
.Sh SEE ALSO
.Xr softflowctl 8 ,
.Xr tcpdump 8 ,
.Xr pcap 3 ,
.Xr bpf 4
.Bd -literal
http://www.cisco.com/univercd/cc/td/doc/product/rtrmgmt/nfc/nfc_3_0/nfc_ug/nfcform.htm
